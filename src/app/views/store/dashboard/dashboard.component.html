<div class="breadcrumb with-back-btn">
  <div class="row">
    <div class="col-md-6 d-flex align-items-center">
      <h1>Dashboard</h1>
    </div>
    <div class="col-md-6">
      <div class="card mb-2">
        <div class="bdr-btm p-3">
          <div class="row">
            <div class="col-6 col-sm-6 col-md-7 d-flex align-items-center">
              <p class="card-data-b-head text-decoration-unl single-line-text-ellipsis mb-0">
                https://shop.yourstore.io/{{commonService.store_details?.sub_domain}}</p>
            </div>
            <div class="col-6 col-sm-6 col-md-5 d-flex align-items-center justify-content-end">
              <a target="_blank" href="https://shop.yourstore.io/{{commonService.store_details?.sub_domain}}">
                <i class="material-icons edit-icon mr-2">visibility</i>
              </a>
              <button (click)="socialShare();" class="btn btn-outline-primary" type="button">
                <span class="outline-primary-txt">Share Link</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="separator-breadcrumb border-top"></div>

<!-- deployment stages -->
<div *ngIf="dispDeployInfo" class="row ml-0 mr-0 mt-4 mb-4">
  <div class="col-md-4 mb-4">
    <div class="home-progress-section-wrapper">
      <div class="progress-step-count">
        <p class="progress-step-count-inner">
          <span>{{completedPercentage}}%</span> completed
        </p>
      </div>
      <div class="stpe-progress-bar">
        <div class="progress-bar">
          <div class="progress-bar-inner" [ngStyle]="{'width.%':completedPercentage}"></div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-12 p-0">
    <div class="data-list-card-wrapper">
      <div class="data-list-card-inner">
        <div *ngFor="let x of deployList; let i=index;" class="data-list-card p-3">
          <div class="row row-flex">
            <div class="col-md-3">
              <div class="data-list-inner-data">
                <p class="m-0 data-head" [ngClass]="i===0? 'complete-strike': ''">{{x.heading}}</p>
                <div *ngIf="x.sub_heading" class="hint-route-breadcrumb-wrapper">
                  <div class="hint-route-breadcrumb">
                    <span>{{x.sub_heading}}</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="data-list-inner-data">
                <p class="m-0 text-small w-sm-100">{{x.description}}</p>
              </div>
            </div>
            <div class="col-md-2">
              <div class="data-list-inner-data">
                <p class="d-flex align-items-center m-0 text-small w-sm-100">
                  <i class="material-icons-outlined mr-1">timer</i> Estimate:{{x.duration}} min
                </p>
              </div>
            </div>
            <div class="col-md-2">
              <div class="data-list-inner-data">
                <p class="m-0 text-small w-sm-100">
                  <span *ngIf="!x.completed" class="badge badge-disabled">Pending</span>
                  <span *ngIf="x.completed" class="badge badge-success">Complete</span>
                </p>
              </div>
            </div>
            <div class="col-md-2">
              <div class="data-list-inner-data d-flex justify-content-center">
                <button *ngIf="!x.completed || i>0" class="btn-primary w-100" type="button" [routerLink]="x.redirect">
                  {{ (x.completed)? 'View': 'Start' }}
                </button>
                <p *ngIf="i===0 && x.completed" class="m-0 text-small w-sm-100">
                  <span class="badge badge-success">Done</span>
                </p>
              </div>
            </div>
          </div>
        </div>
        <!-- more options -->
        <div class="data-list-card show-more-data-list-card">
          <div class="show-more-accordian">
            <div id="accordionOne">
              <div class="card acc-card">
                <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordionOne">
                  <div class="card-body p-0">
                    <div class="data-list-card-wrapper">
                      <div class="data-list-card-inner">
                        <div *ngFor="let x of moreDeployList; let i=index;" class="data-list-card p-3">
                          <div class="row row-flex">
                            <div class="col-md-3">
                              <div class="data-list-inner-data">
                                <p class="m-0 data-head">{{x.heading}}</p>
                                <div *ngIf="x.sub_heading" class="hint-route-breadcrumb-wrapper">
                                  <div class="hint-route-breadcrumb">
                                    <span>{{x.sub_heading}}</span>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="col-md-3">
                              <div class="data-list-inner-data">
                                <p class="m-0 text-small w-sm-100">{{x.description}}</p>
                              </div>
                            </div>
                            <div class="col-md-2">
                              <div class="data-list-inner-data">
                                <p class="d-flex align-items-center m-0 text-small w-sm-100">
                                  <i class="material-icons-outlined mr-1">timer</i> Estimate:{{x.duration}} min
                                </p>
                              </div>
                            </div>
                            <div class="col-md-2">
                              <!-- <div class="data-list-inner-data">
                                <p class="m-0 text-small w-sm-100">
                                  <span *ngIf="!x.completed" class="badge badge-disabled">Pending</span>
                                  <span *ngIf="x.completed" class="badge badge-success">Complete</span>
                                </p>
                              </div> -->
                            </div>
                            <div class="col-md-2">
                              <div class="data-list-inner-data d-flex justify-content-center">
                                <button class="btn-primary w-100" type="button" [routerLink]="x.redirect">View</button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="card-header p-3" id="headingOne">
                  <h5 class="mb-0">
                    <button class="btn btn-link collapsed w-100 p-0 m-0" data-toggle="collapse" data-target="#collapseOne" aria-expanded="fasle" aria-controls="collapseOne">
                      Explore Optional Setup
                      <span class="gray-icon-btn ml-3">
                        <i class="material-icons">expand_more</i>
                      </span>
                    </button>
                  </h5>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- whats new -->
<div class="whats-new-acc card">
  <div id="accordionTwo">
    <div class="acc-card">
      <div class="card-header p-3" id="headingTwo">
        <h5 class="mb-0">
          <button class="btn btn-link collapsed w-100 p-0 m-0" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="fasle" aria-controls="collapseTwo">
            <div class="breadcrumb home-breadcrumb mb-0">
              <h1>What's New</h1>
              <div class="home-headlines mt-2">
                <h4>yourstore Anniversary Refresh</h4>
                <h6>28 Aug 2021</h6>
              </div>
            </div>
            <div class="d-flex align-items-center">
              <span class="learn-more-text">Learn more</span>
              <span class="gray-icon-btn ml-3">
                <i class="material-icons">expand_more</i>
              </span>
            </div>
          </button>
        </h5>
      </div>
      <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionTwo">
        <div class="card-body">
          <div class="row">
            <div class="col-md-12 p-0">
              <div class="col-md-6">
                <div class="card home-card p-3 mb-3">
                  <h5 class="card-title">Quick Checkout
                  </h5>
                  <p>Share a link with pre-filled products to your customers on WhatsApp, Instagram and other channels.</p>
                </div>
              </div>
            </div>
            <div class="col-md-12 p-0">
              <div class="col-md-6">
                <div class="card home-card p-3 mb-3">
                  <h5 class="card-title">Our New Identity
                  </h5>
                  <p>A refreshing new logo and pleasing colour scheme.</p>
                </div>
              </div>
            </div>
            <div class="col-md-12 p-0">
              <div class="col-md-6">
                <div class="card home-card p-3 mb-3">
                  <h5 class="card-title">SMS Validation for CoD
                  </h5>
                  <p>Avoid fake orders through OTP-style validation for CoD orders.</p>
                </div>
              </div>
            </div>
            <div class="col-md-12 p-0">
              <div class="col-md-6">
                <div class="card home-card p-3 mb-3">
                  <h5 class="card-title">Sound Notifications
                  </h5>
                  <p>Get notified when new orders are placed.</p>
                </div>
              </div>
            </div>
            <div class="col-md-12 p-0">
              <div class="col-md-6">
                <div class="card home-card p-3 mb-3">
                  <h5 class="card-title">yourstore PWA
                  </h5>
                  <p>Access yourstore quickly by adding it to your home screen.</p>
                </div>
              </div>
            </div>
            <div class="col-md-12 p-0">
              <div class="col-md-6">
                <hr class="home-sec-spliter">
              </div>
            </div>
            <div class="col-md-12 p-0">
              <div class="col-md-6">
                <div class="card home-card p-3 mb-3">
                  <h5 class="card-title">Colour Consistency</h5>
                  <p>Platform-wide vivid colour usage to bring in more consistency and hierarchy of buttons and elements
                    for easy of use.</p>
                </div>
              </div>
            </div>
            <div class="col-md-12 p-0">
              <div class="col-md-6">
                <div class="card home-card p-3 mb-3">
                  <h5 class="card-title">Language Consistency
                  </h5>
                  <p>UI updated with clearer text and terminology for more coherent usage of the Platform.</p>
                </div>
              </div>
            </div>
            <div class="col-md-12 p-0">
              <div class="col-md-6">
                <div class="card home-card p-3 mb-3">
                  <h5 class="card-title">More Control over yourstore
                  </h5>
                  <p>Manage your Store Plugins and control Store Checkout settings in just a few clicks. Find this under
                    "Settings" in the Plugin Management tab.</p>
                </div>
              </div>
            </div>
            <div class="col-md-12 p-0">
              <div class="col-md-6">
                <div class="card home-card p-3 mb-3">
                  <h5 class="card-title">Update Critical Information
                  </h5>
                  <p>Pixel code, Google Analytics code, Store email and much more can now be updated in the
                    "<span class="info-highlight">Store Settings</span>"
                    tab under "<span class="info-highlight">Settings</span>".
                  </p>
                </div>
              </div>
            </div>
            <div class="col-md-12 p-0">
              <div class="col-md-6">
                <div class="card home-card p-3 mb-3">
                  <h5 class="card-title">More Free Features coming your way</h5>
                  <p>
                    Send WhatsApp messages, email or call abandoned cart customers directly, manage announcement bar content by
                    yourself and we've thrown in a sale countdown timer for the announcement bar to usher in the urgency to
                    complete a purchase from your customers.
                  </p>
                </div>
              </div>
            </div>
            <div class="col-md-12 p-0">
              <div class="col-md-6">
                <hr class="home-sec-spliter">
              </div>
            </div>
            <div class="col-md-12 p-0">
              <div class="col-md-6">
                <div class="card home-card p-3 mb-3">
                  <h5 class="card-title">Mobile Responsive and Optimised Backend</h5>
                  <p>Use all the features of the yourstore backend on your mobile. Manage orders, products, SEO & more on the fly.</p>
                </div>
              </div>
            </div>
            <div class="col-md-12 p-0">
              <div class="col-md-6">
                <div class="card home-card p-3 mb-3">
                  <h5 class="card-title">Optimised UI</h5>
                  <p>UI Elements Design have been optimized for ease of use and understanding with clear definitions for each section.</p>
                </div>
              </div>
            </div>
            <div class="col-md-12 p-0">
              <div class="col-md-6">
                <div class="card home-card p-3 mb-3">
                  <h5 class="card-title">Dark mode</h5>
                  <p>yourstore has just joined the dark mode party. Enjoy using yourstore even at night without straining your eyes with our enhanced dark UI.</p>
                </div>
              </div>
            </div>
            <div class="col-md-12 p-0">
              <div class="col-md-6">
                <div class="card home-card p-3 mb-3">
                  <h5 class="card-title">Dashboard</h5>
                  <p>The new updated dashboard has all the right features for you to run and analyze your business in real-time.</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- dashboard -->
<div *ngIf="dispDashboard" class="row mt-4">
  <div class="col-md-12">
    <div class="card p-3 mb-4">
      <h5 class="card-title">Filter</h5>
      <div class="top-filter-sec">
      <div class="row">
        <div class="col-md-4">
          <div class="form-group">
            <input type="text" placeholder="Select From Date" class="form-control" name="from_date" autocomplete="off" [(ngModel)]="filterForm.from_date"
              (ngModelChange)="filterForm.type='custom'; getDashboardData();" bsDatepicker [bsConfig]="{ showWeekNumbers: false, dateInputFormat: 'DD-MM-YYYY' }"
            />
          </div>
        </div>
        <div class="col-md-4">
          <div class="form-group">
            <input type="text" placeholder="Select To Date" class="form-control" name="to_date" autocomplete="off" [(ngModel)]="filterForm.to_date"
              (ngModelChange)="filterForm.type='custom'; getDashboardData();" bsDatepicker [minDate]="filterForm.from_date"
              [bsConfig]="{ showWeekNumbers: false, dateInputFormat: 'DD-MM-YYYY' }" />
          </div>
        </div>
        <div class="col-md-4">
          <div class="form-group">
            <select name="type" class="form-control select-arrow" [(ngModel)]="filterForm.type" (change)="filterForm.type!='custom' ? onFilterChange(filterForm.type): ''">
              <option value="today">Today</option>
              <option value="yesterday">Yesterday</option>
              <option value="last_7_days">Last 7 days</option>
              <option value="last_30_days">Last 30 days</option>
              <option value="current_month">Current month</option>
              <option value="last_month">Last month</option>
              <option value="current_year">Current year</option>
              <option value="last_year">Last year</option>
              <option value="current_fin_year">Current financial year</option>
              <option value="last_fin_year">Last financial year</option>
              <option value="all_time">All time</option>
              <option value="custom">Custom</option>
            </select>
          </div>
        </div>
      </div>
      </div>
    </div>
  </div>

  <div class="col-lg-6 col-md-12">
    <!-- CARD ICON -->
    <div class="row m-0">
      <div class="col-lg-4 col-md-6 col-sm-6 d-flex">
        <div class="card card-icon w-100 mb-4">
          <div class="card-body text-center">
            <i class="material-icons">cloud_upload</i>
            <p class="text-muted text-gradient mt-2 mb-2">Uploads</p>
            <p class="text-primary text-18 line-height-1 m-0">
              <i *ngIf="preLoader" class="fa fa-circle-o-notch fa-spin load-spin"></i>
              <span *ngIf="!preLoader">{{order_details?.products}}</span>
            </p>
          </div>
        </div>
      </div>

      <div class="col-lg-4 col-md-6 col-sm-6 d-flex">
        <div class="card card-icon w-100 mb-4">
          <div class="card-body text-center">
            <i class="material-icons">person_pin_circle</i>
            <p class="text-muted text-gradient mt-2 mb-2">New Customers</p>
            <p class="text-primary text-18 line-height-1 m-0">
              <i *ngIf="customerLoader" class="fa fa-circle-o-notch fa-spin load-spin"></i>
              <span *ngIf="!customerLoader">{{customer_details?.total_customers}}</span>
            </p>
          </div>
        </div>
      </div>

      <div class="col-lg-4 col-md-6 col-sm-6 d-flex">
        <div class="card card-icon w-100 mb-4">
          <div class="card-body text-center">
            <i class="material-icons">monetization_on</i>
            <p class="text-muted text-gradient mt-2 mb-2">Total Sales</p>
            <p class="text-primary text-18 line-height-1 m-0">
              <i *ngIf="preLoader" class="fa fa-circle-o-notch fa-spin load-spin"></i>
              <span *ngIf="!preLoader">{{order_details?.total_sales | number : '1.0-0'}}</span>
            </p>
          </div>
        </div>
      </div>


      <div class="col-lg-4 col-md-6 col-sm-6 d-flex">
        <div class="card card-icon w-100 mb-4">
          <div class="card-body text-center">
            <i class="material-icons">settings_backup_restore</i>
            <p class="text-muted text-gradient mt-2 mb-2">Total Orders</p>
            <p class="line-height-1 text-title text-18 mt-2 mb-0">
              <i *ngIf="preLoader" class="fa fa-circle-o-notch fa-spin load-spin"></i>
              <span *ngIf="!preLoader">{{order_details?.order_list?.length}}</span>
            </p>
          </div>
        </div>
      </div>
      <div class="col-lg-4 col-md-6 col-sm-6 d-flex">
        <div class="card card-icon w-100 mb-4">
          <div class="card-body text-center">
            <i class="material-icons">all_out</i>
            <p class="text-muted text-gradient mt-2 mb-2">Average Order Value</p>
            <p class="line-height-1 text-title text-18 mt-2 mb-0">
              <i *ngIf="preLoader" class="fa fa-circle-o-notch fa-spin load-spin"></i>
              <span *ngIf="!preLoader && order_details?.order_list?.length">
                {{ (order_details?.total_sales / order_details?.order_list?.length).toFixed(0) | number : '1.0-0' }}
              </span>
              <span *ngIf="!preLoader && !order_details?.order_list?.length">0</span>
            </p>
          </div>
        </div>
      </div>
      <div class="col-lg-4 col-md-6 col-sm-6 d-flex">
        <div class="card card-icon w-100 mb-4">
          <div class="card-body text-center">
            <i class="material-icons">remove_shopping_cart</i>
            <p class="text-muted text-gradient mt-2 mb-2">Abandoned Carts</p>
            <p class="line-height-1 text-title text-18 mt-2 mb-0">
              <i *ngIf="customerLoader" class="fa fa-circle-o-notch fa-spin load-spin"></i>
              <span *ngIf="!customerLoader">{{customer_details?.abandoned_count}}</span>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-lg-6 col-md-12 d-flex">
    <div class="card w-100 mb-4">
      <div class="card-body">
        <h5 class="card-title">Order Volume</h5>
        <div *ngIf="preLoader" class="d-flex justify-content-center">
          <i class="fa fa-circle-o-notch fa-spin load-spin"></i>
        </div>
        <div *ngIf="!preLoader && order_details?.order_list?.length" echarts [options]="chartLine" style="height: 300px"></div>
        <div class="d-flex align-items-center justify-content-center" *ngIf="!preLoader && !order_details?.order_list?.length">
          <p>No orders found</p>
        </div>
      </div>
    </div>
  </div>

  <div class="col-lg-6 col-md-12 d-flex">
    <div class="card w-100 mb-4">
      <div class="card-body">
        <div class="card-title">Orders</div>
        <div class="row">
          <div class="col-md-12">
            <table class="table">
              <thead class="thead-light">
                <tr>
                  <th scope="col">Status</th>
                  <th scope="col">Quantity</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Awaiting Confirmation</td>
                  <td class="text-warning font-weight-bold">
                    <i *ngIf="preLoader" class="fa fa-circle-o-notch fa-spin load-spin"></i>
                    <span *ngIf="!preLoader">{{order_details?.placed_orders}}</span>
                  </td>
                </tr>
                <tr>
                  <td>Confirmed</td>
                  <td class="font-weight-bold" style="color: #42bcf5;">
                    <i *ngIf="preLoader" class="fa fa-circle-o-notch fa-spin load-spin"></i>
                    <span *ngIf="!preLoader">{{order_details?.confirmed_orders}}</span>
                  </td>
                </tr>
                <tr>
                  <td>In Transit</td>
                  <td class="text-success font-weight-bold">
                    <i *ngIf="preLoader" class="fa fa-circle-o-notch fa-spin load-spin"></i>
                    <span *ngIf="!preLoader">{{order_details?.dispatched_orders}}</span>
                  </td>
                </tr>
                <tr>
                  <td>Payment Pending</td>
                  <td class="font-weight-bold" style="color: #f56725;">
                    <i *ngIf="preLoader" class="fa fa-circle-o-notch fa-spin load-spin"></i>
                    <span *ngIf="!preLoader">{{order_details?.pending_orders}}</span>
                  </td>
                </tr>
                <tr>
                  <td>Completed</td>
                  <td class="font-weight-bold" style="color: #d83967;">
                    <i *ngIf="preLoader" class="fa fa-circle-o-notch fa-spin load-spin"></i>
                    <span *ngIf="!preLoader">{{order_details?.completed_orders}}</span>
                  </td>
                </tr>
                <tr>
                  <td>Cancelled</td>
                  <td class="font-weight-bold" style="color: #a9a9a9;">
                    <i *ngIf="preLoader" class="fa fa-circle-o-notch fa-spin load-spin"></i>
                    <span *ngIf="!preLoader">{{order_details?.cancelled_orders}}</span>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="col-md-12">
            <div *ngIf="preLoader">
              <i class="fa fa-circle-o-notch fa-spin load-spin"></i>
            </div>
            <div id="dashboard-piechart" *ngIf="!preLoader" echarts [options]="chartPie" [autoResize]="true" style="height: 200px;"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-lg-6 col-md-12 d-flex">
    <div class="card w-100 mb-4">
      <div class="card-body">
        <div class="card-title">Top Customers</div>
        <div *ngIf="customerLoader" class="d-flex justify-content-center">
          <i class="fa fa-circle-o-notch fa-spin load-spin"></i>
        </div>
        <div *ngIf="!customerLoader">
          <ng-container *ngIf="customer_details?.top_customers?.length">
            <div *ngFor="let x of customer_details.top_customers;" class="d-flex align-items-center border-bottom-dotted-dim pb-3 mb-3 top-customer">
              <i class="material-icons">person_pin_circle</i>
              <div class="flex-grow-1 mr-3">
                <h6 class="m-0">{{x?.name}}</h6>
                <p class="m-0 text-small text-muted">{{x.total_qty}} items purchased for {{x.total_price | currency: commonService.store_currency?.country_code}}</p>
              </div>
              <div>
                <a routerLink="/customers/{{x._id}}" class="btn btn-wide btn-outline-primary">
                  <span class="outline-primary-txt">View</span>
                </a>
              </div>
            </div>
          </ng-container>
          <div *ngIf="!customer_details?.top_customers?.length" class="d-flex align-items-center justify-content-center">
            <p>No customers found</p>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>